    <div class="client-section">
        <label for="clientName">Nome do Cliente:</label>
        <input type="text" id="clientName" placeholder="Digite o nome do cliente" />
    </div>

    <div class="table-selector">
        <label for="priceTable">Selecione a Tabela de Preços:</label>
        <select id="priceTable" onchange="atualizarPrecos()">
            <option value="cost">Preço de Custo</option>
            <option value="30">30% de Margem</option>
            <option value="50">50% de Margem</option>
            <option value="100">100% de Margem</option>
        </select>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th style="width: 35%;">Item</th>
                    <th style="width: 8%;">Selecionar</th>
                    <th style="width: 12%;">Quantidade</th>
                    <th style="width: 15%;">Preço Unit.</th>
                    <th style="width: 15%;">Instalação</th>
                    <th style="width: 15%;">Total</th>
                </tr>
            </thead>
            <tbody id="tabelaItens"></tbody>
        </table>
    </div>

    <div class="summary-section">
        <div class="summary-card">
            <h3>Total Equipamentos</h3>
            <p id="totalEquipamentos">R$ 0,00</p>
        </div>
        <div class="summary-card">
            <h3>Total Instalação</h3>
            <p id="totalInstalacao">R$ 0,00</p>
        </div>
        <div class="summary-card">
            <h3>Total Geral</h3>
            <p id="totalGeral">R$ 0,00</p>
        </div>
    </div>

    <div class="mensalidade-section">
        <h3>Selecione o Tipo de Mensalidade:</h3>
        <div class="radio-group">
            <div class="radio-option">
                <input type="radio" id="semTatico" name="mensalidade" value="390" checked onchange="calcularTotais()" />
                <label for="semTatico">Sem Tático - R$ 390,00/mês</label>
            </div>
            <div class="radio-option">
                <input type="radio" id="comTatico" name="mensalidade" value="490" onchange="calcularTotais()" />
                <label for="comTatico">Com Tático - R$ 490,00/mês</label>
            </div>
        </div>
    </div>

    <button class="export-btn" onclick="gerarPropostaHTML()">Gerar Proposta em HTML</button>
</div>

<script>
    const items = [
        { name: "Câmera IP Bullet Positivo", cost: 182.99, p30: 237.89, p50: 274.49, p100: 365.98, install: 110 },
        { name: "Câmera IM5", cost: 428.92, p30: 557.6, p50: 643.38, p100: 857.84, install: 110 },
        { name: "Central de Alarme AMT 1000 Smart", cost: 334.12, p30: 434.36, p50: 501.18, p100: 668.24, install: 150 },
        { name: "Sensor Interno IVP 1000 Sem Fio", cost: 82.8, p30: 107.64, p50: 124.2, p100: 165.6, install: 80 },
        { name: "Sensor Externo Sem Fio IVP 7000", cost: 365.4, p30: 475.02, p50: 548.1, p100: 730.8, install: 80 },
        { name: "Controle XAC 2003", cost: 19.9, p30: 25.87, p50: 29.85, p100: 39.8, install: 0 },
        { name: "Sirene", cost: 18.91, p30: 24.58, p50: 28.37, p100: 37.82, install: 0 },
        { name: "Bateria Central", cost: 66.51, p30: 86.46, p50: 99.77, p100: 133.02, install: 0 },
        { name: "Poste", cost: 1200, p30: 1560, p50: 1800, p100: 2400, install: 0 },
        { name: "Security Box", cost: 1500, p30: 1950, p50: 2250, p100: 3000, install: 150 },
        { name: "Grade Proteção para Câmeras", cost: 34.32, p30: 44.62, p50: 51.48, p100: 68.64, install: 0 },
        { name: "Fonte Chaveada 12V", cost: 32, p30: 41.6, p50: 48, p100: 64, install: 0 },
        { name: "Hub", cost: 45.9, p30: 59.67, p50: 68.85, p100: 91.8, install: 0 },
        { name: "Cabo Manga 6 Vias (metro)", cost: 6, p30: 7.8, p50: 9, p100: 12, install: 0 },
        { name: "Cabo Manga 4 Vias (metro)", cost: 4, p30: 5.2, p50: 6, p100: 8, install: 0 },
        { name: "Cabo de Energia (metro)", cost: 1, p30: 1.3, p50: 1.5, p100: 2, install: 0 },
        { name: "Cabo CFTV (metro)", cost: 0.83, p30: 1.08, p50: 1.25, p100: 1.66, install: 0 },
        { name: "Cabo de Rede (metro)", cost: 1, p30: 1.3, p50: 1.5, p100: 2, install: 0 },
        { name: "Régua de Energia", cost: 20, p30: 26, p50: 30, p100: 40, install: 0 },
        { name: "Caixa de Passagem/Emenda", cost: 16, p30: 20.8, p50: 24, p100: 32, install: 0 },
        { name: "Fita Isolante", cost: 3.5, p30: 4.55, p50: 5.25, p100: 7, install: 0 },
        { name: "Controle de Acesso Facial 3531", cost: 739.99, p30: 961.99, p50: 1109.99, p100: 1479.98, install: 0 },
        { name: "Controle de Acesso Facial 3532", cost: 849.9, p30: 1104.87, p50: 1274.85, p100: 1699.8, install: 0 },
        { name: "Controle de Acesso Facial 3532 MF W", cost: 1200, p30: 1560, p50: 1800, p100: 2400, install: 0 }
    ];

    function formatCurrency(value) {
        return `R$ ${value.toFixed(2).replace('.', ',')}`;
    }

    function popularTabela() {
        const tbody = document.getElementById('tabelaItens');
        tbody.innerHTML = '';
        items.forEach((item, index) => {
            const row = tbody.insertRow();
            row.innerHTML = `
                <td>${item.name}</td>
                <td style="text-align: center;"><input type="checkbox" data-index="${index}"></td>
                <td><input type="number" data-index="${index}" value="1" min="1"></td>
                <td class="preco-unit"></td>
                <td>${formatCurrency(item.install)}</td>
                <td class="total-item">R$ 0,00</td>
            `;
        });

        const checkboxes = document.querySelectorAll('#tabelaItens input[type="checkbox"]');
        const quantities = document.querySelectorAll('#tabelaItens input[type="number"]');

        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', calcularTotais);
        });
        quantities.forEach(input => {
            input.addEventListener('input', () => {
                if (input.value < 1) input.value = 1;
                calcularTotais();
            });
        });
    }

    function atualizarPrecos() {
        const tabelaSelecionada = document.getElementById('priceTable').value;
        const precosUnit = document.querySelectorAll('.preco-unit');
        items.forEach((item, index) => {
            let preco;
            if (tabelaSelecionada === 'cost') {
                preco = item.cost;
            } else {
                preco = item['p' + tabelaSelecionada];
            }
            precosUnit[index].textContent = formatCurrency(preco);
        });
        calcularTotais();
    }

    function calcularTotais() {
        const tabelaSelecionada = document.getElementById('priceTable').value;
        let totalEquipamentos = 0;
        let totalInstalacao = 0;

        const linhas = document.querySelectorAll('#tabelaItens tr');
        linhas.forEach((linha, index) => {
            const item = items[index];
            const checkbox = linha.querySelector('input[type="checkbox"]');
            const quantidade = parseInt(linha.querySelector('input[type="number"]').value) || 0;

            let precoUnit;
            if (tabelaSelecionada === 'cost') {
                precoUnit = item.cost;
            } else {
                precoUnit = item['p' + tabelaSelecionada];
            }

            let totalItem = 0;
            if (checkbox.checked) {
                const equipTotal = precoUnit * quantidade;
                const installTotal = item.install * quantidade;
                totalItem = equipTotal + installTotal;

                totalEquipamentos += equipTotal;
                totalInstalacao += installTotal;
            }

            linha.querySelector('.total-item').textContent = formatCurrency(totalItem);
        });

        document.getElementById('totalEquipamentos').textContent = formatCurrency(totalEquipamentos);
        document.getElementById('totalInstalacao').textContent = formatCurrency(totalInstalacao);
        document.getElementById('totalGeral').textContent = formatCurrency(totalEquipamentos + totalInstalacao);
    }

    function gerarPropostaHTML() {
        const clientName = document.getElementById('clientName').value.trim();
        if (!clientName) {
            alert('Por favor, digite o nome do cliente antes de gerar a proposta.');
            return;
        }

        const tabelaSelecionada = document.getElementById('priceTable').value;
        let html = `
        <html>
        <head>
            <title>Proposta Virtual Fence - ${clientName}</title>
            <style>
                body { font-family: Arial, sans-serif; background: #fff; color: #000; padding: 20px; }
                h1 { color: #00d4ff; }
                table { border-collapse: collapse; width: 100%; margin-top: 20px; }
                th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
                th { background-color: #00d4ff; color: white; }
                .total { font-weight: bold; font-size: 1.2em; margin-top: 20px; }
            </style>
        </head>
        <body>
        <h1>Proposta para: ${clientName}</h1>
        <h2>Tabela: ${tabelaSelecionada === 'cost' ? 'Preço de Custo' : tabelaSelecionada + '% de Margem'}</h2>
        <table>
            <thead>
                <tr><th>Item</th><th>Preço Unit.</th><th>Quantidade</th><th>Total</th></tr>
            </thead>
            <tbody>
        `;

        let totalGeral = 0;

        items.forEach((item, index) => {
            const checkbox = document.querySelector(`input[type="checkbox"][data-index="${index}"]`);
            if (checkbox && checkbox.checked) {
                const qtyInput = document.querySelector(`input[type="number"][data-index="${index}"]`);
                const qty = qtyInput ? parseInt(qtyInput.value) || 0 : 0;
                let price = tabelaSelecionada === 'cost' ? item.cost : item['p' + tabelaSelecionada];
                let totalItem = (price * qty) + (item.install * qty);
                totalGeral += totalItem;
                html += `
                <tr>
                    <td>${item.name}</td>
                    <td>${formatCurrency(price)}</td>
                    <td>${qty}</td>
                    <td>${formatCurrency(totalItem)}</td>
                </tr>
                `;
            }
        });

        html += `
            </tbody>
        </table>
        <div class="total">Total Geral: ${formatCurrency(totalGeral)}</div>
        </body>
        </html>
        `;

        const newWindow = window.open();
        newWindow.document.write(html);
        newWindow.document.close();
    }

    document.addEventListener("DOMContentLoaded", () => {
        popularTabela();
        atualizarPrecos();
    });
</script>
